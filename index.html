<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FinTrack Pro - –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π —Ç—Ä–µ–∫–µ—Ä</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #4361ee;
            --primary-light: #4895ef;
            --secondary: #3f37c9;
            --success: #4cc9f0;
            --danger: #f72585;
            --warning: #f8961e;
            --dark: #1e1e2c;
            --light: #f8f9fa;
            --gray: #6c757d;
            --border-radius: 12px;
            --box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f7fb;
            color: var(--dark);
            line-height: 1.6;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }

        /* Header */
        header {
            background-color: white;
            box-shadow: var(--box-shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 700;
            font-size: 1.5rem;
            color: var(--primary);
        }

        .logo-icon {
            background-color: var(--primary);
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .header-actions {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .btn {
            padding: 10px 20px;
            border-radius: var(--border-radius);
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            font-size: 0.9rem;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--secondary);
        }

        .btn-outline {
            background-color: transparent;
            border: 1px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline:hover {
            background-color: var(--primary);
            color: white;
        }
              
        /* Main App */
        .app-container {
            display: flex;
            min-height: calc(100vh - 80px);
        }

        .sidebar {
            width: 250px;
            background-color: white;
            box-shadow: var(--box-shadow);
            padding: 20px 0;
            transition: var(--transition);
        }

        .sidebar-menu {
            list-style: none;
        }

        .sidebar-menu li {
            margin-bottom: 5px;
        }

        .sidebar-menu a {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 20px;
            text-decoration: none;
            color: var(--dark);
            transition: var(--transition);
        }

        .sidebar-menu a:hover, .sidebar-menu a.active {
            background-color: rgba(67, 97, 238, 0.1);
            color: var(--primary);
        }

        .sidebar-menu i {
            width: 20px;
            text-align: center;
        }

        .main-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        .page-title {
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .page-title h2 {
            font-size: 1.8rem;
            color: var(--dark);
        }

        /* Cards */
        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
            text-align: center;
        }

        .stat-card.income {
            border-left: 4px solid var(--success);
        }

        .stat-card.expense {
            border-left: 4px solid var(--danger);
        }

        .stat-card.balance {
            border-left: 4px solid var(--primary);
        }

        .stat-card h3 {
            font-size: 0.9rem;
            color: var(--gray);
            margin-bottom: 10px;
        }

        .stat-card .amount {
            font-size: 1.5rem;
            font-weight: 700;
        }

        /* Forms */
        .form-container {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
            margin-bottom: 30px;
        }

        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-group {
            flex: 1;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
        }

        .form-control:focus {
            border-color: var(--primary);
            outline: none;
        }

        /* Tables */
        .table-container {
            background-color: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--box-shadow);
            margin-bottom: 30px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        th {
            background-color: #f8f9fa;
            font-weight: 600;
        }

        tr:hover {
            background-color: #f8f9fa;
        }

        .income-amount {
            color: var(--success);
            font-weight: 600;
        }

        .expense-amount {
            color: var(--danger);
            font-weight: 600;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
        }

        .btn-sm {
            padding: 5px 10px;
            font-size: 0.8rem;
        }

        .btn-danger {
            background-color: var(--danger);
            color: white;
        }

        .btn-success {
            background-color: var(--success);
            color: white;
        }

        /* Tasks */
        .task-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .task-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
            border-left: 4px solid var(--primary);
        }

        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .task-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .task-priority {
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
        }

        .priority-high {
            background: #ffebee;
            color: var(--danger);
        }

        .priority-medium {
            background: #fff3e0;
            color: var(--warning);
        }

        .priority-low {
            background: #e8f5e8;
            color: var(--success);
        }

        .task-description {
            color: var(--gray);
            margin-bottom: 15px;
            line-height: 1.4;
        }

        .task-meta {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            color: var(--gray);
            margin-bottom: 15px;
        }

        .task-actions {
            display: flex;
            gap: 10px;
        }

        .task-completed {
            opacity: 0.6;
            text-decoration: line-through;
        }

        /* Analytics */
        .analytics-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .chart-container {
            background: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
        }

        .chart-container h3 {
            margin-bottom: 15px;
            color: var(--dark);
        }

        .analytics-filters {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            align-items: center;
            flex-wrap: wrap;
        }

        .category-filters {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .category-filter {
            padding: 8px 15px;
            background: #f8f9fa;
            border-radius: 20px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .category-filter.active {
            background: var(--primary);
            color: white;
        }

        /* Goals */
        .goals-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 20px;
        }

        .goal-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
            border-left: 4px solid var(--primary);
        }

        .goal-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .goal-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .goal-category {
            background: #f0f0f0;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            color: var(--gray);
        }

        .goal-progress {
            margin: 15px 0;
        }

        .progress-bar {
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--primary);
            transition: width 0.3s ease;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            color: var(--gray);
            margin-top: 5px;
        }

        .goal-meta {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            color: var(--gray);
            margin-top: 10px;
        }

        .goal-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        /* Quick Actions */
        .quick-actions {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .quick-action {
            flex: 1;
            min-width: 150px;
            background: white;
            border-radius: var(--border-radius);
            padding: 20px;
            text-align: center;
            box-shadow: var(--box-shadow);
            cursor: pointer;
            transition: var(--transition);
        }

        .quick-action:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(0, 0, 0, 0.1);
        }

        .quick-action i {
            font-size: 2rem;
            margin-bottom: 10px;
            color: var(--primary);
        }

        /* User Menu */
        .user-menu {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }

        .user-name {
            font-weight: 500;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background-color: white;
            border-radius: var(--border-radius);
            width: 90%;
            max-width: 500px;
            padding: 30px;
            box-shadow: var(--box-shadow);
            position: relative;
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray);
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 15px 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            border-left: 4px solid var(--success);
            z-index: 3000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.error {
            border-left-color: var(--danger);
        }

        .notification.warning {
            border-left-color: var(--warning);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .app-container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                padding: 10px 0;
            }
            
            .sidebar-menu {
                display: flex;
                overflow-x: auto;
            }
            
            .sidebar-menu li {
                margin-bottom: 0;
                flex-shrink: 0;
            }
            
            .sidebar-menu a {
                padding: 10px 15px;
                flex-direction: column;
                text-align: center;
                font-size: 0.8rem;
            }
            
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            
            .analytics-grid {
                grid-template-columns: 1fr;
            }
            
            .quick-actions {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon">FT</div>
                    <span>FinTrack Pro</span>
                </div>
                
                <div class="header-actions" id="headerActions">
                    <button class="btn btn-outline" id="loginBtn">–í–æ–π—Ç–∏</button>
                    <button class="btn btn-primary" id="registerBtn">–ù–∞—á–∞—Ç—å –ø—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥</button>
                </div>
                
                <div class="user-menu" id="userMenu" style="display: none;">
                    <div class="user-avatar" id="userAvatar">U</div>
                    <span class="user-name" id="userName">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</span>
                    <button class="btn btn-outline" id="logoutBtn">–í—ã–π—Ç–∏</button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main App -->
    <div class="app-container" id="appContainer" style="display: none;">
        <div class="sidebar">
            <ul class="sidebar-menu">
                <li><a href="#" class="nav-link active" data-page="dashboard"><i class="fas fa-chart-line"></i> <span>–î–∞—à–±–æ—Ä–¥</span></a></li>
                <li><a href="#" class="nav-link" data-page="transactions"><i class="fas fa-exchange-alt"></i> <span>–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏</span></a></li>
                <li><a href="#" class="nav-link" data-page="tasks"><i class="fas fa-tasks"></i> <span>–ó–∞–¥–∞—á–∏</span></a></li>
                <li><a href="#" class="nav-link" data-page="analytics"><i class="fas fa-chart-pie"></i> <span>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</span></a></li>
                <li><a href="#" class="nav-link" data-page="goals"><i class="fas fa-bullseye"></i> <span>–¶–µ–ª–∏</span></a></li>
                <li><a href="#" class="nav-link" data-page="subscription"><i class="fas fa-crown"></i> <span>–ü–æ–¥–ø–∏—Å–∫–∞</span></a></li>
            </ul>
        </div>
        
        <div class="main-content">
            <!-- Dashboard Page -->
            <div class="page active" id="dashboard">
                <div class="page-title">
                    <h2>–î–∞—à–±–æ—Ä–¥</h2>
                    <span id="currentDate"></span>
                </div>
                
                <div class="quick-actions">
                    <div class="quick-action" onclick="showPage('transactions')">
                        <i class="fas fa-plus-circle"></i>
                        <h3>–î–æ–±–∞–≤–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é</h3>
                    </div>
                    <div class="quick-action" onclick="showPage('tasks')">
                        <i class="fas fa-tasks"></i>
                        <h3>–ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞</h3>
                    </div>
                    <div class="quick-action" onclick="showPage('analytics')">
                        <i class="fas fa-chart-bar"></i>
                        <h3>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</h3>
                    </div>
                    <div class="quick-action" onclick="showPage('goals')">
                        <i class="fas fa-bullseye"></i>
                        <h3>–ú–æ–∏ —Ü–µ–ª–∏</h3>
                    </div>
                </div>
                
                <div class="stats-cards">
                    <div class="stat-card income">
                        <h3>–î–æ—Ö–æ–¥—ã</h3>
                        <div class="amount" id="totalIncome">0 ‚ÇΩ</div>
                    </div>
                    <div class="stat-card expense">
                        <h3>–†–∞—Å—Ö–æ–¥—ã</h3>
                        <div class="amount" id="totalExpense">0 ‚ÇΩ</div>
                    </div>
                    <div class="stat-card balance">
                        <h3>–ë–∞–ª–∞–Ω—Å</h3>
                        <div class="amount" id="totalBalance">0 ‚ÇΩ</div>
                    </div>
                </div>
                
                <div class="table-container">
                    <h3>–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>–î–∞—Ç–∞</th>
                                <th>–û–ø–∏—Å–∞–Ω–∏–µ</th>
                                <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                                <th>–°—É–º–º–∞</th>
                            </tr>
                        </thead>
                        <tbody id="recentTransactions">
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Transactions Page -->
            <div class="page" id="transactions">
                <div class="page-title">
                    <h2>–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏</h2>
                    <button class="btn btn-primary" onclick="showAddTransactionModal()">–î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é</button>
                </div>
                
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>–î–∞—Ç–∞</th>
                                <th>–¢–∏–ø</th>
                                <th>–û–ø–∏—Å–∞–Ω–∏–µ</th>
                                <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                                <th>–°—É–º–º–∞</th>
                                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                            </tr>
                        </thead>
                        <tbody id="allTransactions">
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Tasks Page -->
            <div class="page" id="tasks">
                <div class="page-title">
                    <h2>–ó–∞–¥–∞—á–∏</h2>
                    <button class="btn btn-primary" onclick="showAddTaskModal()">–î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É</button>
                </div>
                
                <div class="task-grid" id="taskList">
                </div>
            </div>

            <!-- Analytics Page -->
            <div class="page" id="analytics">
                <div class="page-title">
                    <h2>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</h2>
                </div>
                
                <div class="analytics-filters">
                    <select id="analyticsPeriod" class="form-control">
                        <option value="month">–ó–∞ –º–µ—Å—è—Ü</option>
                        <option value="quarter">–ó–∞ –∫–≤–∞—Ä—Ç–∞–ª</option>
                        <option value="year">–ó–∞ –≥–æ–¥</option>
                    </select>
                    
                    <div class="category-filters" id="categoryFilters">
                    </div>
                </div>
                
                <div class="analytics-grid">
                    <div class="chart-container">
                        <h3>–†–∞—Å—Ö–æ–¥—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º</h3>
                        <canvas id="categoryChart" height="250"></canvas>
                    </div>
                    <div class="chart-container">
                        <h3>–î–∏–Ω–∞–º–∏–∫–∞ –¥–æ—Ö–æ–¥–æ–≤/—Ä–∞—Å—Ö–æ–¥–æ–≤</h3>
                        <canvas id="trendChart" height="250"></canvas>
                    </div>
                </div>
            </div>

            <!-- Goals Page -->
            <div class="page" id="goals">
                <div class="page-title">
                    <h2>–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ü–µ–ª–∏</h2>
                    <button class="btn btn-primary" onclick="showAddGoalModal()">–ù–æ–≤–∞—è —Ü–µ–ª—å</button>
                </div>
                
                <div class="goals-grid" id="goalsList">
                </div>
            </div>
            
            <!-- Subscription Page -->
            <div class="page" id="subscription">
                <div class="page-title">
                    <h2>–ü–æ–¥–ø–∏—Å–∫–∞</h2>
                </div>
                
                <div class="form-container">
                    <h3>–¢–µ–∫—É—â–∏–π –ø–ª–∞–Ω</h3>
                    <div id="currentPlan">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Transaction Modal -->
    <div class="modal" id="addTransactionModal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('addTransactionModal')">&times;</span>
            <h2 class="modal-title">–î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é</h2>
            <form id="transactionForm">
                <div class="form-group">
                    <label>–¢–∏–ø</label>
                    <select class="form-control" id="transactionType" required>
                        <option value="income">–î–æ—Ö–æ–¥</option>
                        <option value="expense">–†–∞—Å—Ö–æ–¥</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>–°—É–º–º–∞</label>
                    <input type="number" class="form-control" id="transactionAmount" placeholder="0" required>
                </div>
                <div class="form-group">
                    <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                    <select class="form-control" id="transactionCategory" required>
                    </select>
                </div>
                <div class="form-group">
                    <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
                    <input type="text" class="form-control" id="transactionDescription" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏">
                </div>
                <div class="form-group">
                    <label>–î–∞—Ç–∞</label>
                    <input type="date" class="form-control" id="transactionDate" required>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">–î–æ–±–∞–≤–∏—Ç—å</button>
            </form>
        </div>
    </div>

    <!-- Add Task Modal -->
    <div class="modal" id="addTaskModal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('addTaskModal')">&times;</span>
            <h2 class="modal-title">–î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É</h2>
            <form id="taskForm">
                <div class="form-group">
                    <label>–ù–∞–∑–≤–∞–Ω–∏–µ</label>
                    <input type="text" class="form-control" id="taskTitle" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏" required>
                </div>
                <div class="form-group">
                    <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
                    <textarea class="form-control" id="taskDescription" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏" rows="3"></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</label>
                        <select class="form-control" id="taskPriority" required>
                            <option value="low">–ù–∏–∑–∫–∏–π</option>
                            <option value="medium" selected>–°—Ä–µ–¥–Ω–∏–π</option>
                            <option value="high">–í—ã—Å–æ–∫–∏–π</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>–î–∞—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</label>
                        <input type="date" class="form-control" id="taskDueDate">
                    </div>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">–î–æ–±–∞–≤–∏—Ç—å</button>
            </form>
        </div>
    </div>

    <!-- Add Goal Modal -->
    <div class="modal" id="addGoalModal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('addGoalModal')">&times;</span>
            <h2 class="modal-title">–ù–æ–≤–∞—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤–∞—è —Ü–µ–ª—å</h2>
            <form id="goalForm">
                <div class="form-group">
                    <label>–ù–∞–∑–≤–∞–Ω–∏–µ —Ü–µ–ª–∏</label>
                    <input type="text" class="form-control" id="goalTitle" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ù–∞–∫–æ–ø–∏—Ç—å –Ω–∞ –º–∞—à–∏–Ω—É" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>–¶–µ–ª–µ–≤–∞—è —Å—É–º–º–∞</label>
                        <input type="number" class="form-control" id="goalAmount" placeholder="0" required>
                    </div>
                    <div class="form-group">
                        <label>–¢–µ–∫—É—â–∏–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è</label>
                        <input type="number" class="form-control" id="goalCurrent" placeholder="0" value="0">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>–î–∞—Ç–∞ —Ü–µ–ª–∏</label>
                        <input type="date" class="form-control" id="goalDate" required>
                    </div>
                    <div class="form-group">
                        <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è —Ü–µ–ª–∏</label>
                        <select class="form-control" id="goalCategory">
                            <option value="auto">–ê–≤—Ç–æ–º–æ–±–∏–ª—å</option>
                            <option value="travel">–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ</option>
                            <option value="house">–ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å</option>
                            <option value="education">–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ</option>
                            <option value="other">–î—Ä—É–≥–æ–µ</option>
                        </select>
                    </div>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">–°–æ–∑–¥–∞—Ç—å —Ü–µ–ª—å</button>
            </form>
        </div>
    </div>

    <!-- Auth Modals (–æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) -->
    <div class="modal" id="registerModal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('registerModal')">&times;</span>
            <h2 class="modal-title">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
            <form id="registerForm">
                <div class="form-group">
                    <label>–ò–º—è</label>
                    <input type="text" id="registerName" class="form-control" required>
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="registerEmail" class="form-control" required>
                </div>
                <div class="form-group">
                    <label>–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" id="registerPassword" class="form-control" required minlength="6">
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                <div style="text-align: center; margin-top: 20px;">
                    <p>–£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? <a href="#" onclick="closeModal('registerModal'); openModal('loginModal')">–í–æ–π—Ç–∏</a></p>
                </div>
            </form>
        </div>
    </div>

    <div class="modal" id="loginModal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('loginModal')">&times;</span>
            <h2 class="modal-title">–í—Ö–æ–¥ –≤ –∞–∫–∫–∞—É–Ω—Ç</h2>
            <form id="loginForm">
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="loginEmail" class="form-control" required>
                </div>
                <div class="form-group">
                    <label>–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" id="loginPassword" class="form-control" required>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">–í–æ–π—Ç–∏</button>
                <div style="text-align: center; margin-top: 20px;">
                    <p>–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? <a href="#" onclick="closeModal('loginModal'); openModal('registerModal')">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a></p>
                </div>
            </form>
        </div>
    </div>

    <script>
        // –û—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        let currentUser = null;
        let transactions = [];
        let tasks = [];
        let goals = [];
        let categories = [
            // –î–æ—Ö–æ–¥—ã
            { id: 1, name: "–ó–∞—Ä–ø–ª–∞—Ç–∞", type: "income", icon: "üíº", color: "#4CAF50" },
            { id: 2, name: "–§—Ä–∏–ª–∞–Ω—Å", type: "income", icon: "üíª", color: "#2196F3" },
            { id: 3, name: "–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏", type: "income", icon: "üìà", color: "#FF9800" },
            
            // –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã
            { id: 4, name: "–ü—Ä–æ–¥—É–∫—Ç—ã", type: "expense", icon: "üõí", color: "#4CAF50" },
            { id: 5, name: "–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç", type: "expense", icon: "üöó", color: "#2196F3" },
            { id: 6, name: "–ñ–∏–ª—å–µ", type: "expense", icon: "üè†", color: "#FF9800" },
            { id: 7, name: "–ö–æ–º–º—É–Ω–∞–ª–∫–∞", type: "expense", icon: "üí°", color: "#F44336" },
            { id: 8, name: "–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è", type: "expense", icon: "üé¨", color: "#673AB7" },
            { id: 9, name: "–ó–¥–æ—Ä–æ–≤—å–µ", type: "expense", icon: "üè•", color: "#4CAF50" },
            { id: 10, name: "–û–¥–µ–∂–¥–∞", type: "expense", icon: "üëï", color: "#795548" },
            { id: 11, name: "–î—Ä—É–≥–æ–µ", type: "both", icon: "üì¶", color: "#9E9E9E" }
        ];

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            setupEventListeners();
            checkAuthStatus();
        });

        function initializeApp() {
            if (!localStorage.getItem('finTrackUsers')) {
                localStorage.setItem('finTrackUsers', JSON.stringify([]));
            }
            if (!localStorage.getItem('finTrackTransactions')) {
                localStorage.setItem('finTrackTransactions', JSON.stringify([]));
            }
            if (!localStorage.getItem('finTrackTasks')) {
                localStorage.setItem('finTrackTasks', JSON.stringify([]));
            }
            if (!localStorage.getItem('finTrackGoals')) {
                localStorage.setItem('finTrackGoals', JSON.stringify([]));
            }
            
            populateCategorySelects();
            setupCategoryFilters();
        }

        function setupEventListeners() {
            // –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
            document.getElementById('loginBtn').addEventListener('click', () => openModal('loginModal'));
            document.getElementById('registerBtn').addEventListener('click', () => openModal('registerModal'));
            document.getElementById('logoutBtn').addEventListener('click', handleLogout);
            
            // –§–æ—Ä–º—ã
            document.getElementById('registerForm').addEventListener('submit', handleRegister);
            document.getElementById('loginForm').addEventListener('submit', handleLogin);
            document.getElementById('transactionForm').addEventListener('submit', handleTransactionSubmit);
            document.getElementById('taskForm').addEventListener('submit', handleTaskSubmit);
            document.getElementById('goalForm').addEventListener('submit', handleGoalSubmit);
            
            // –ù–∞–≤–∏–≥–∞—Ü–∏—è
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const pageId = this.getAttribute('data-page');
                    showPage(pageId);
                    
                    document.querySelectorAll('.nav-link').forEach(item => {
                        item.classList.remove('active');
                    });
                    this.classList.add('active');
                });
            });

            // –§–∏–ª—å—Ç—Ä—ã –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
            document.getElementById('analyticsPeriod').addEventListener('change', updateAnalytics);
        }

        // –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)
        function handleRegister(e) {
            e.preventDefault();
            
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value.toLowerCase();
            const password = document.getElementById('registerPassword').value;
            
            const users = JSON.parse(localStorage.getItem('finTrackUsers'));
            
            if (users.find(u => u.email === email)) {
                showNotification('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω', 'error');
                return;
            }
            
            const newUser = {
                id: Date.now(),
                name,
                email,
                password: btoa(password),
                subscription: 'trial',
                createdAt: new Date().toISOString()
            };
            
            users.push(newUser);
            localStorage.setItem('finTrackUsers', JSON.stringify(users));
            
            currentUser = newUser;
            localStorage.setItem('finTrackCurrentUser', JSON.stringify(newUser));
            
            closeModal('registerModal');
            showApp();
            showNotification(`–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${name}!`, 'success');
        }

        function handleLogin(e) {
            e.preventDefault();
            
            const email = document.getElementById('loginEmail').value.toLowerCase();
            const password = document.getElementById('loginPassword').value;
            
            const users = JSON.parse(localStorage.getItem('finTrackUsers'));
            const user = users.find(u => u.email === email && u.password === btoa(password));
            
            if (user) {
                currentUser = user;
                localStorage.setItem('finTrackCurrentUser', JSON.stringify(user));
                closeModal('loginModal');
                showApp();
                showNotification(`–° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º, ${user.name}!`, 'success');
            } else {
                showNotification('–ù–µ–≤–µ—Ä–Ω—ã–π email –∏–ª–∏ –ø–∞—Ä–æ–ª—å', 'error');
            }
        }

        function handleLogout() {
            currentUser = null;
            localStorage.removeItem('finTrackCurrentUser');
            showAuth();
            showNotification('–í—ã –≤—ã—à–ª–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã', 'success');
        }

        function checkAuthStatus() {
            const userData = localStorage.getItem('finTrackCurrentUser');
            if (userData) {
                currentUser = JSON.parse(userData);
                showApp();
            } else {
                showAuth();
            }
        }

        function showApp() {
            document.getElementById('appContainer').style.display = 'flex';
            document.getElementById('headerActions').style.display = 'none';
            document.getElementById('userMenu').style.display = 'flex';
            document.getElementById('userAvatar').textContent = currentUser.name.charAt(0).toUpperCase();
            document.getElementById('userName').textContent = currentUser.name;
            
            loadUserData();
            updateUI();
            updateCurrentDate();
        }

        function showAuth() {
            document.getElementById('appContainer').style.display = 'none';
            document.getElementById('headerActions').style.display = 'flex';
            document.getElementById('userMenu').style.display = 'none';
        }

        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏
        function loadUserData() {
            if (!currentUser) return;
            
            const allTransactions = JSON.parse(localStorage.getItem('finTrackTransactions'));
            const allTasks = JSON.parse(localStorage.getItem('finTrackTasks'));
            const allGoals = JSON.parse(localStorage.getItem('finTrackGoals') || '[]');
            
            transactions = allTransactions.filter(t => t.userId === currentUser.id);
            tasks = allTasks.filter(t => t.userId === currentUser.id);
            goals = allGoals.filter(g => g.userId === currentUser.id);
        }

        function updateUI() {
            updateFinancialStats();
            updateTransactionTables();
            updateTaskList();
            updateGoalsDisplay();
            updateSubscriptionInfo();
        }

        // –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
        function showAddTransactionModal() {
            document.getElementById('transactionDate').value = new Date().toISOString().split('T')[0];
            openModal('addTransactionModal');
        }

        function handleTransactionSubmit(e) {
            e.preventDefault();
            
            const type = document.getElementById('transactionType').value;
            const amount = parseFloat(document.getElementById('transactionAmount').value);
            const categoryId = parseInt(document.getElementById('transactionCategory').value);
            const description = document.getElementById('transactionDescription').value;
            const date = document.getElementById('transactionDate').value;
            
            addTransaction(type, amount, categoryId, description, date);
            document.getElementById('transactionForm').reset();
            closeModal('addTransactionModal');
        }

        function addTransaction(type, amount, categoryId, description, date) {
            const newTransaction = {
                id: Date.now(),
                userId: currentUser.id,
                type,
                amount,
                categoryId,
                description,
                date,
                createdAt: new Date().toISOString()
            };
            
            transactions.push(newTransaction);
            
            const allTransactions = JSON.parse(localStorage.getItem('finTrackTransactions'));
            allTransactions.push(newTransaction);
            localStorage.setItem('finTrackTransactions', JSON.stringify(allTransactions));
            
            updateUI();
            showNotification('–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞!', 'success');
        }

        function deleteTransaction(id) {
            if (!confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é?')) return;
            
            transactions = transactions.filter(t => t.id !== id);
            const allTransactions = JSON.parse(localStorage.getItem('finTrackTransactions'));
            const updatedTransactions = allTransactions.filter(t => t.id !== id);
            localStorage.setItem('finTrackTransactions', JSON.stringify(updatedTransactions));
            
            updateUI();
            showNotification('–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∞!', 'success');
        }

        // –ó–∞–¥–∞—á–∏
        function showAddTaskModal() {
            document.getElementById('taskDueDate').value = new Date().toISOString().split('T')[0];
            openModal('addTaskModal');
        }

        function handleTaskSubmit(e) {
            e.preventDefault();
            
            const title = document.getElementById('taskTitle').value;
            const description = document.getElementById('taskDescription').value;
            const priority = document.getElementById('taskPriority').value;
            const dueDate = document.getElementById('taskDueDate').value;
            
            addTask(title, description, priority, dueDate);
            document.getElementById('taskForm').reset();
            closeModal('addTaskModal');
        }

        function addTask(title, description, priority, dueDate) {
            const newTask = {
                id: Date.now(),
                userId: currentUser.id,
                title,
                description,
                priority,
                dueDate,
                completed: false,
                createdAt: new Date().toISOString()
            };
            
            tasks.push(newTask);
            
            const allTasks = JSON.parse(localStorage.getItem('finTrackTasks'));
            allTasks.push(newTask);
            localStorage.setItem('finTrackTasks', JSON.stringify(allTasks));
            
            updateUI();
            showNotification('–ó–∞–¥–∞—á–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞!', 'success');
        }

        function toggleTaskCompletion(id) {
            const task = tasks.find(t => t.id === id);
            if (task) {
                task.completed = !task.completed;
                
                const allTasks = JSON.parse(localStorage.getItem('finTrackTasks'));
                const taskIndex = allTasks.findIndex(t => t.id === id);
                if (taskIndex !== -1) {
                    allTasks[taskIndex].completed = task.completed;
                    localStorage.setItem('finTrackTasks', JSON.stringify(allTasks));
                }
                
                updateUI();
            }
        }

        function deleteTask(id) {
            if (!confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É –∑–∞–¥–∞—á—É?')) return;
            
            tasks = tasks.filter(t => t.id !== id);
            const allTasks = JSON.parse(localStorage.getItem('finTrackTasks'));
            const updatedTasks = allTasks.filter(t => t.id !== id);
            localStorage.setItem('finTrackTasks', JSON.stringify(updatedTasks));
            
            updateUI();
            showNotification('–ó–∞–¥–∞—á–∞ —É–¥–∞–ª–µ–Ω–∞!', 'success');
        }

        // –¶–µ–ª–∏
        function showAddGoalModal() {
            const nextYear = new Date();
            nextYear.setFullYear(nextYear.getFullYear() + 1);
            document.getElementById('goalDate').value = nextYear.toISOString().split('T')[0];
            openModal('addGoalModal');
        }

        function handleGoalSubmit(e) {
            e.preventDefault();
            
            const title = document.getElementById('goalTitle').value;
            const targetAmount = parseFloat(document.getElementById('goalAmount').value);
            const currentAmount = parseFloat(document.getElementById('goalCurrent').value);
            const targetDate = document.getElementById('goalDate').value;
            const category = document.getElementById('goalCategory').value;
            
            addGoal(title, targetAmount, currentAmount, targetDate, category);
            document.getElementById('goalForm').reset();
            closeModal('addGoalModal');
        }

        function addGoal(title, targetAmount, currentAmount, targetDate, category) {
            const newGoal = {
                id: Date.now(),
                userId: currentUser.id,
                title,
                targetAmount,
                currentAmount,
                targetDate,
                category,
                createdAt: new Date().toISOString()
            };
            
            goals.push(newGoal);
            saveGoals();
            updateGoalsDisplay();
            showNotification('–¶–µ–ª—å —Å–æ–∑–¥–∞–Ω–∞!', 'success');
        }

        function updateGoalProgress(id, newAmount) {
            const goal = goals.find(g => g.id === id);
            if (goal) {
                goal.currentAmount = newAmount;
                saveGoals();
                updateGoalsDisplay();
            }
        }

        function deleteGoal(id) {
            if (!confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É —Ü–µ–ª—å?')) return;
            
            goals = goals.filter(g => g.id !== id);
            saveGoals();
            updateGoalsDisplay();
            showNotification('–¶–µ–ª—å —É–¥–∞–ª–µ–Ω–∞!', 'success');
        }

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function updateFinancialStats() {
            const totalIncome = transactions
                .filter(t => t.type === 'income')
                .reduce((sum, t) => sum + t.amount, 0);
                
            const totalExpense = transactions
                .filter(t => t.type === 'expense')
                .reduce((sum, t) => sum + t.amount, 0);
                
            const totalBalance = totalIncome - totalExpense;
            
            document.getElementById('totalIncome').textContent = `${totalIncome} ‚ÇΩ`;
            document.getElementById('totalExpense').textContent = `${totalExpense} ‚ÇΩ`;
            document.getElementById('totalBalance').textContent = `${totalBalance} ‚ÇΩ`;
        }

        function updateTransactionTables() {
            // –ù–µ–¥–∞–≤–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–ª—è –¥–∞—à–±–æ—Ä–¥–∞
            const recentTransactions = [...transactions]
                .sort((a, b) => new Date(b.date) - new Date(a.date))
                .slice(0, 5);
                
            const recentTable = document.getElementById('recentTransactions');
            recentTable.innerHTML = '';
            
            recentTransactions.forEach(transaction => {
                const category = categories.find(c => c.id == transaction.categoryId);
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${formatDate(transaction.date)}</td>
                    <td>${transaction.description || '-'}</td>
                    <td>${category ? category.name : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</td>
                    <td class="${transaction.type === 'income' ? 'income-amount' : 'expense-amount'}">
                        ${transaction.type === 'income' ? '+' : '-'}${transaction.amount} ‚ÇΩ
                    </td>
                `;
                
                recentTable.appendChild(row);
            });
            
            // –í—Å–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
            const allTable = document.getElementById('allTransactions');
            allTable.innerHTML = '';
            
            transactions.forEach(transaction => {
                const category = categories.find(c => c.id == transaction.categoryId);
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${formatDate(transaction.date)}</td>
                    <td>${transaction.type === 'income' ? '–î–æ—Ö–æ–¥' : '–†–∞—Å—Ö–æ–¥'}</td>
                    <td>${transaction.description || '-'}</td>
                    <td>${category ? category.name : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</td>
                    <td class="${transaction.type === 'income' ? 'income-amount' : 'expense-amount'}">
                        ${transaction.amount} ‚ÇΩ
                    </td>
                    <td>
                        <button class="btn btn-danger btn-sm" onclick="deleteTransaction(${transaction.id})">–£–¥–∞–ª–∏—Ç—å</button>
                    </td>
                `;
                
                allTable.appendChild(row);
            });
        }

        function updateTaskList() {
            const taskList = document.getElementById('taskList');
            taskList.innerHTML = '';
            
            tasks.forEach(task => {
                const taskCard = document.createElement('div');
                taskCard.className = `task-card ${task.completed ? 'task-completed' : ''}`;
                
                taskCard.innerHTML = `
                    <div class="task-header">
                        <div>
                            <div class="task-title">${task.title}</div>
                        </div>
                        <span class="task-priority priority-${task.priority}">
                            ${task.priority === 'high' ? '–í—ã—Å–æ–∫–∏–π' : task.priority === 'medium' ? '–°—Ä–µ–¥–Ω–∏–π' : '–ù–∏–∑–∫–∏–π'}
                        </span>
                    </div>
                    <div class="task-description">${task.description || '–ù–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è'}</div>
                    <div class="task-meta">
                        <span>–°—Ä–æ–∫: ${task.dueDate ? formatDate(task.dueDate) : '–ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω'}</span>
                    </div>
                    <div class="task-actions">
                        <button class="btn btn-success btn-sm" onclick="toggleTaskCompletion(${task.id})">
                            ${task.completed ? '–í–æ–∑–æ–±–Ω–æ–≤–∏—Ç—å' : '–ó–∞–≤–µ—Ä—à–∏—Ç—å'}
                        </button>
                        <button class="btn btn-danger btn-sm" onclick="deleteTask(${task.id})">–£–¥–∞–ª–∏—Ç—å</button>
                    </div>
                `;
                
                taskList.appendChild(taskCard);
            });
        }

        function updateGoalsDisplay() {
            const goalsList = document.getElementById('goalsList');
            goalsList.innerHTML = '';
            
            goals.forEach(goal => {
                const progress = (goal.currentAmount / goal.targetAmount) * 100;
                const daysLeft = Math.ceil((new Date(goal.targetDate) - new Date()) / (1000 * 60 * 60 * 24));
                
                const goalCard = document.createElement('div');
                goalCard.className = 'goal-card';
                goalCard.innerHTML = `
                    <div class="goal-header">
                        <div>
                            <div class="goal-title">${goal.title}</div>
                            <span class="goal-category">${goal.category}</span>
                        </div>
                    </div>
                    <div class="goal-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${Math.min(progress, 100)}%"></div>
                        </div>
                        <div class="progress-info">
                            <span>${goal.currentAmount} ‚ÇΩ</span>
                            <span>${goal.targetAmount} ‚ÇΩ</span>
                        </div>
                    </div>
                    <div class="goal-meta">
                        <span>–ü—Ä–æ–≥—Ä–µ—Å—Å: ${progress.toFixed(1)}%</span>
                        <span>–û—Å—Ç–∞–ª–æ—Å—å: ${daysLeft} –¥–Ω.</span>
                    </div>
                    <div class="goal-actions">
                        <input type="number" class="form-control" placeholder="–ù–æ–≤–∞—è —Å—É–º–º–∞" 
                               onchange="updateGoalProgress(${goal.id}, parseFloat(this.value))">
                        <button class="btn btn-danger btn-sm" onclick="deleteGoal(${goal.id})">–£–¥–∞–ª–∏—Ç—å</button>
                    </div>
                `;
                
                goalsList.appendChild(goalCard);
            });
        }

        function updateAnalytics() {
            createCategoryChart();
            createTrendChart();
        }

        function createCategoryChart() {
            const ctx = document.getElementById('categoryChart').getContext('2d');
            const expenseCategories = categories.filter(c => c.type === 'expense');
            const expenseData = expenseCategories.map(category => {
                const categoryTransactions = transactions.filter(t => 
                    t.type === 'expense' && t.categoryId === category.id
                );
                return categoryTransactions.reduce((sum, t) => sum + t.amount, 0);
            });
            
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: expenseCategories.map(c => c.name),
                    datasets: [{
                        data: expenseData,
                        backgroundColor: expenseCategories.map(c => c.color)
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function createTrendChart() {
            const ctx = document.getElementById('trendChart').getContext('2d');
            
            // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ –º–µ—Å—è—Ü–∞–º
            const monthlyData = {};
            transactions.forEach(transaction => {
                const date = new Date(transaction.date);
                const monthKey = `${date.getFullYear()}-${date.getMonth() + 1}`;
                
                if (!monthlyData[monthKey]) {
                    monthlyData[monthKey] = { income: 0, expense: 0 };
                }
                
                if (transaction.type === 'income') {
                    monthlyData[monthKey].income += transaction.amount;
                } else {
                    monthlyData[monthKey].expense += transaction.amount;
                }
            });
            
            const labels = Object.keys(monthlyData).sort();
            const incomeData = labels.map(label => monthlyData[label].income);
            const expenseData = labels.map(label => monthlyData[label].expense);
            
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: '–î–æ—Ö–æ–¥—ã',
                            data: incomeData,
                            borderColor: '#4CAF50',
                            backgroundColor: 'rgba(76, 175, 80, 0.1)',
                            tension: 0.4
                        },
                        {
                            label: '–†–∞—Å—Ö–æ–¥—ã',
                            data: expenseData,
                            borderColor: '#F44336',
                            backgroundColor: 'rgba(244, 67, 54, 0.1)',
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true
                }
            });
        }

        function setupCategoryFilters() {
            const filtersContainer = document.getElementById('categoryFilters');
            categories.forEach(category => {
                if (category.type === 'expense') {
                    const filter = document.createElement('div');
                    filter.className = 'category-filter active';
                    filter.textContent = category.name;
                    filter.onclick = function() {
                        this.classList.toggle('active');
                        // –ó–¥–µ—Å—å –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –ø–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
                    };
                    filtersContainer.appendChild(filter);
                }
            });
        }

        function populateCategorySelects() {
            const select = document.getElementById('transactionCategory');
            select.innerHTML = '';
            
            categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category.id;
                option.textContent = `${category.icon} ${category.name}`;
                select.appendChild(option);
            });
        }

        function updateSubscriptionInfo() {
            const currentPlanDiv = document.getElementById('currentPlan');
            currentPlanDiv.innerHTML = `
                <p>–£ –≤–∞—Å –∞–∫—Ç–∏–≤–µ–Ω <strong>${currentUser.subscription === 'trial' ? '–ø—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥' : '–±–∞–∑–æ–≤—ã–π –ø–ª–∞–Ω'}</strong>.</p>
                <p>${currentUser.subscription === 'trial' ? '–û—Å—Ç–∞–ª–æ—Å—å 7 –¥–Ω–µ–π –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è' : '–°—Ç–æ–∏–º–æ—Å—Ç—å: 250‚ÇΩ/–º–µ—Å—è—Ü'}</p>
            `;
        }

        function saveGoals() {
            const allGoals = JSON.parse(localStorage.getItem('finTrackGoals') || '[]');
            const userGoals = allGoals.filter(g => g.userId !== currentUser.id);
            localStorage.setItem('finTrackGoals', JSON.stringify([...userGoals, ...goals]));
        }

        // –£—Ç–∏–ª–∏—Ç—ã
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
            
            if (pageId === 'analytics') {
                updateAnalytics();
            }
        }

        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `<p>${message}</p>`;
            document.body.appendChild(notification);
            
            setTimeout(() => notification.classList.add('show'), 100);
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => document.body.removeChild(notification), 300);
            }, 4000);
        }

        function updateCurrentDate() {
            const now = new Date();
            document.getElementById('currentDate').textContent = now.toLocaleDateString('ru-RU', { 
                day: 'numeric', month: 'long', year: 'numeric' 
            });
        }

        function formatDate(dateString) {
            return new Date(dateString).toLocaleDateString('ru-RU');
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –∏—Ö
        window.addEventListener('click', function(e) {
            if (e.target.classList.contains('modal')) {
                e.target.style.display = 'none';
            }
        });
    </script>
</body>
</html>